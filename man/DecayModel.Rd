% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/a_r6_class.R
\name{DecayModel}
\alias{DecayModel}
\title{DecayModel class}
\description{
A class to represent a decay model
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{name}}{Model name}

\item{\code{decay_function}}{The decay function}

\item{\code{param_config}}{Parameter configuration}

\item{\code{optimization_results}}{Results from the last optimization}

\item{\code{nlrob_samples}}{List of nlrob samples}

\item{\code{ve_summary}}{Summary of VE samples}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-DecayModel-new}{\code{DecayModel$new()}}
\item \href{#method-DecayModel-evaluate}{\code{DecayModel$evaluate()}}
\item \href{#method-DecayModel-create_nls_formula}{\code{DecayModel$create_nls_formula()}}
\item \href{#method-DecayModel-fit_to_determine_bic}{\code{DecayModel$fit_to_determine_bic()}}
\item \href{#method-DecayModel-generate_VE_based_on_resampling}{\code{DecayModel$generate_VE_based_on_resampling()}}
\item \href{#method-DecayModel-generate_VE_summary}{\code{DecayModel$generate_VE_summary()}}
\item \href{#method-DecayModel-plot_VE_with_uncertainty}{\code{DecayModel$plot_VE_with_uncertainty()}}
\item \href{#method-DecayModel-plot_VE_with_uncertainty_plus_raw_data}{\code{DecayModel$plot_VE_with_uncertainty_plus_raw_data()}}
\item \href{#method-DecayModel-plot_bootstrap_samples}{\code{DecayModel$plot_bootstrap_samples()}}
\item \href{#method-DecayModel-get_optimal_params}{\code{DecayModel$get_optimal_params()}}
\item \href{#method-DecayModel-get_aic}{\code{DecayModel$get_aic()}}
\item \href{#method-DecayModel-get_bic}{\code{DecayModel$get_bic()}}
\item \href{#method-DecayModel-predict_optimal}{\code{DecayModel$predict_optimal()}}
\item \href{#method-DecayModel-predict}{\code{DecayModel$predict()}}
\item \href{#method-DecayModel-plot_optimal}{\code{DecayModel$plot_optimal()}}
\item \href{#method-DecayModel-plot}{\code{DecayModel$plot()}}
\item \href{#method-DecayModel-print}{\code{DecayModel$print()}}
\item \href{#method-DecayModel-build_prediction_dataset}{\code{DecayModel$build_prediction_dataset()}}
\item \href{#method-DecayModel-clone}{\code{DecayModel$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-new"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-new}{}}}
\subsection{Method \code{new()}}{
Initialize a specific decay model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$new(name, decay_function, param_config)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{name}}{Model name}

\item{\code{decay_function}}{Function that implements the decay model}

\item{\code{param_config}}{Parameter configuration list}
}
\if{html}{\out{</div>}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-evaluate"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-evaluate}{}}}
\subsection{Method \code{evaluate()}}{
Evaluate the model with given parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$evaluate(time_steps, params)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{time_steps}}{Time steps to evaluate}

\item{\code{params}}{Named vector of parameters}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Vector of decay values
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-create_nls_formula"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-create_nls_formula}{}}}
\subsection{Method \code{create_nls_formula()}}{
Create formula for nls fitting
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$create_nls_formula()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Formula suitable for nls
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-fit_to_determine_bic"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-fit_to_determine_bic}{}}}
\subsection{Method \code{fit_to_determine_bic()}}{
Fit the model using 3-step strategy (nlxb -> nls -> bootstrap)
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$fit_to_determine_bic(
  estimate,
  ci_low,
  ci_up,
  periods_starts,
  periods_ends,
  seed = 123,
  maxiteritations = 50,
  type_of_fit = "midpoint"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{estimate}}{Log estimates (in the HR scale)}

\item{\code{ci_low}}{Lower confidence interval bounds (in the HR scale)}

\item{\code{ci_up}}{Upper confidence interval bounds (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{seed}}{Seed for reproducibility (default is 123)}

\item{\code{maxiteritations}}{Maximum number of iterations for nls (default is 500)}

\item{\code{type_of_fit}}{Type of fit (default is "midpoint")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List with fitting results
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-generate_VE_based_on_resampling"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-generate_VE_based_on_resampling}{}}}
\subsection{Method \code{generate_VE_based_on_resampling()}}{
Generate VE based on boot fit
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$generate_VE_based_on_resampling(
  estimate,
  ci_low,
  ci_up,
  periods_starts,
  periods_ends,
  n_weekly_ve_to_generate = 1000,
  type_of_fit = "midpoint",
  seed = 123
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{estimate}}{Log estimates (in the HR scale)}

\item{\code{ci_low}}{Lower confidence interval bounds (in the HR scale)}

\item{\code{ci_up}}{Upper confidence interval bounds (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{n_weekly_ve_to_generate}}{Number of weekly VE to generate (default is 1000)}

\item{\code{type_of_fit}}{Type of fit (default is "midpoint")}

\item{\code{seed}}{Seed for reproducibility (default is 123)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Matrix of VE samples
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-generate_VE_summary"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-generate_VE_summary}{}}}
\subsection{Method \code{generate_VE_summary()}}{
Generate VE summary statistics from bootstrap samples
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$generate_VE_summary(
  periods_starts,
  periods_ends,
  probs = c(0.025, 0.5, 0.975)
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{probs}}{Vector of quantiles to compute (default is c(0.025, 0.5, 0.975))}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Data frame with summary statistics
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-plot_VE_with_uncertainty"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-plot_VE_with_uncertainty}{}}}
\subsection{Method \code{plot_VE_with_uncertainty()}}{
Plot VE with uncertainty bands from bootstrap
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$plot_VE_with_uncertainty(
  periods_starts,
  periods_ends,
  title = NULL,
  color = "blue",
  alpha = 0.3,
  show_points = TRUE,
  probs = c(0.025, 0.975)
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{title}}{Plot title (default is NULL)}

\item{\code{color}}{Color for the line and ribbon (default is "blue")}

\item{\code{alpha}}{Transparency for the ribbon (default is 0.3)}

\item{\code{show_points}}{Whether to show points on the line (default is TRUE)}

\item{\code{probs}}{Vector of quantiles for confidence intervals (default is c(0.025, 0.975))}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-plot_VE_with_uncertainty_plus_raw_data"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-plot_VE_with_uncertainty_plus_raw_data}{}}}
\subsection{Method \code{plot_VE_with_uncertainty_plus_raw_data()}}{
Plot VE with uncertainty bands from bootstrap
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$plot_VE_with_uncertainty_plus_raw_data(
  estimate,
  ci_low,
  ci_up,
  periods_starts,
  periods_ends,
  title = NULL,
  color = "blue",
  alpha = 0.3,
  show_points = TRUE,
  probs = c(0.025, 0.975)
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{estimate}}{Log estimates (in the HR scale)}

\item{\code{ci_low}}{Lower confidence interval bounds (in the HR scale)}

\item{\code{ci_up}}{Upper confidence interval bounds (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{title}}{Plot title (default is NULL)}

\item{\code{color}}{Color for the line and ribbon (default is "blue")}

\item{\code{alpha}}{Transparency for the ribbon (default is 0.3)}

\item{\code{show_points}}{Whether to show points on the line (default is TRUE)}

\item{\code{probs}}{Vector of quantiles for confidence intervals (default is c(0.025, 0.975))}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-plot_bootstrap_samples"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-plot_bootstrap_samples}{}}}
\subsection{Method \code{plot_bootstrap_samples()}}{
Plot individual bootstrap samples
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$plot_bootstrap_samples(
  periods_starts,
  periods_ends,
  n_samples = 5,
  title = NULL,
  alpha = 0.7
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{n_samples}}{Number of bootstrap samples to show (default is 5)}

\item{\code{title}}{Plot title (default is NULL)}

\item{\code{alpha}}{Transparency for the lines (default is 0.7)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-get_optimal_params"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-get_optimal_params}{}}}
\subsection{Method \code{get_optimal_params()}}{
Get optimal parameters from last optimization
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$get_optimal_params()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Named vector of optimal parameters
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-get_aic"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-get_aic}{}}}
\subsection{Method \code{get_aic()}}{
Get AIC value from last optimization
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$get_aic()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
AIC value
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-get_bic"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-get_bic}{}}}
\subsection{Method \code{get_bic()}}{
Get BIC value from last optimization
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$get_bic()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
BIC value
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-predict_optimal"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-predict_optimal}{}}}
\subsection{Method \code{predict_optimal()}}{
Predict using optimal parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$predict_optimal(
  estimate,
  periods_starts,
  periods_ends,
  aggregate_by_8_weeks = FALSE,
  criterion = "aic"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{estimate}}{estimates (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{aggregate_by_8_weeks}}{Whether to aggregate the predictions by 8 weeks (default is FALSE)}

\item{\code{criterion}}{Criterion to use for prediction (default is "aic")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Vector of predictions
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-predict"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-predict}{}}}
\subsection{Method \code{predict()}}{
Predict decay model for given parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$predict(
  params,
  estimate,
  periods_starts,
  periods_ends,
  aggregate_by_8_weeks = FALSE,
  criterion = "aic"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{params}}{Named vector of parameters}

\item{\code{estimate}}{estimates (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{aggregate_by_8_weeks}}{Whether to aggregate the predictions by 8 weeks (default is FALSE)}

\item{\code{criterion}}{Criterion to use for prediction (default is "aic")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Vector of predictions
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-plot_optimal"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-plot_optimal}{}}}
\subsection{Method \code{plot_optimal()}}{
Plot using optimal parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$plot_optimal(
  estimate,
  ci_low,
  ci_up,
  periods_starts,
  periods_ends,
  title = NULL,
  color = "red",
  age_group,
  site,
  season,
  outcome
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{estimate}}{Vector of estimates (in the HR scale)}

\item{\code{ci_low}}{Lower confidence interval (in the HR scale)}

\item{\code{ci_up}}{Upper confidence interval (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{title}}{Plot title}

\item{\code{color}}{Color of the line}

\item{\code{age_group}}{Age group}

\item{\code{site}}{Site}

\item{\code{season}}{Season}

\item{\code{outcome}}{Outcome}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-plot"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-plot}{}}}
\subsection{Method \code{plot()}}{
Plot decay model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$plot(
  params,
  estimate,
  ci_low,
  ci_up,
  periods_starts,
  periods_ends,
  title = NULL,
  color = "red",
  age_group,
  site,
  season,
  outcome
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{params}}{Named vector of parameters}

\item{\code{estimate}}{Vector of estimates (in the HR scale)}

\item{\code{ci_low}}{Lower confidence interval (in the HR scale)}

\item{\code{ci_up}}{Upper confidence interval (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{title}}{Plot title}

\item{\code{color}}{Color of the line (default is "red")}

\item{\code{age_group}}{Age group}

\item{\code{site}}{Site}

\item{\code{season}}{Season}

\item{\code{outcome}}{Outcome}

\item{\code{criterion}}{Criterion to use for prediction (default is "aic")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-print"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-print}{}}}
\subsection{Method \code{print()}}{
Print model information
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$print()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-build_prediction_dataset"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-build_prediction_dataset}{}}}
\subsection{Method \code{build_prediction_dataset()}}{
Build final dataset with weekly and 8-weeks predictions
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$build_prediction_dataset(
  estimate,
  ci_low,
  ci_up,
  periods_starts,
  periods_ends,
  include_weekly = TRUE,
  include_8_weeks = TRUE,
  criterion = "aic"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{estimate}}{Vector of estimates (in the HR scale)}

\item{\code{ci_low}}{Vector of lower confidence interval bounds (in the HR scale)}

\item{\code{ci_up}}{Vector of upper confidence interval bounds (in the HR scale)}

\item{\code{periods_starts}}{Vector of periods starts}

\item{\code{periods_ends}}{Vector of periods ends}

\item{\code{include_weekly}}{Whether to include weekly predictions (default is TRUE)}

\item{\code{include_8_weeks}}{Whether to include 8-weeks predictions (default is TRUE)}

\item{\code{criterion}}{Criterion to use for prediction (default is "aic")}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List containing weekly_data and data_8_weeks data frames
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-DecayModel-clone"></a>}}
\if{latex}{\out{\hypertarget{method-DecayModel-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{DecayModel$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
